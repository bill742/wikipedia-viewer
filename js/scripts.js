var output,searchArticle;output="",searchArticle=function(){var e;return e=search.value,e=e.replace(/\s+/g,"%20"),""===e?$(".search-container").before("<p class='error'>Please enter a search query</p>"):($("p.error").hide(),$("#output").empty(),$.ajax({type:"GET",url:"https://en.wikipedia.org/w/api.php?action=query&format=json&prop=pageimages|extracts&generator=search&formatversion=1&pilimit=50&exsentences=1&exlimit=20&exintro=1&explaintext=1&gsrnamespace=0&gsrsearch="+e+"&gsrlimit=10&callback=?",contentType:"application/json; charset=utf-8",async:!1,dataType:"json",success:function(e,t,r){var a,n;return console.log(e),n=e.query.pages,a=Object.keys(n).map(function(e){return n[e]}),$(".read-more").remove(),$(".output").removeClass("output-visible"),a.forEach(function(e){return document.getElementById("output").innerHTML+="<div class='box'><h3>"+e.title+"</h3><p>"+e.extract+"</p><p class='read-more'><a href='https://en.wikipedia.org/?curid="+e.pageid+"' target='_blank'>Read More &gt;&gt;</a></p></div>"})},error:function(e){return $(".output").addClass("output-visible"),output="<p>No results found.</p>",document.getElementById("output").innerHTML=output}}))},$("#search").keypress(function(){if(13===event.keyCode||13===event.which)return searchArticle()}),$("#random").click(function(){return $("#output").empty(),$.ajax({type:"GET",url:"http://en.wikipedia.org/w/api.php?action=query&generator=random&grnnamespace=0&prop=extracts&exchars=500&format=json&rnlimit=1&callback=?",contentType:"application/json; charset=utf-8",async:!1,dataType:"json",success:function(e,t,r){var a,n,o,u,p,i,c,s;return c=e.query.pages,i=Object.keys(c).map(function(e){return c[e]}),s=i[0],n=s.title,u=s.extract,o=$(u).find("p"),p=o.prevObject[0].innerHTML,a=s.pageid,$(".output").addClass("output-visible"),output="<h3>"+n+"</h3>",output+="<p>"+p+"</p>",output+='<p class="read-more"><a href="http://en.wikipedia.org/wiki?curid='+a+'" target="_blank">Read More &gt;&gt;</a></p>',document.getElementById("output").innerHTML=output,{error:function(e){return console.log("No article found")}}}})});